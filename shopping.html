<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <link href="./images/pgo.ico" rel="icon" />
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link
  href="https://fonts.googleapis.com/css2?family=Abel&family=Noto+Sans+TC:wght@100;200;300;400;500;600;700;800;900&family=Poppins:wght@100;200;300;400;500;600;700;800;900&display=swap"
  rel="stylesheet"
/>

    <link rel="stylesheet" href="./css/style.css" />
    <title>Go結帳 | PetpaGo</title>
    <link href="./images/pgo.ico" rel="icon" />
  </head>

  <body>
    <div class="wrapper shopping bg_gray">
      <header>
  <a href="index.html">
    <img src="./images/logo/PetpaGo-logo.svg" alt="PetpaGo logo" />
  </a>
  <ul class="navList col-10">
    <li class="nav_item" data-content="GO旅宿" onclick="navigateTo('hostel.html')">
      <a href="./hostel.html">GO旅宿</a>
    </li>
    <li class="nav_item" data-content="GO司機" onclick="navigateTo('driver.html')">
      <a href="./driver.html">GO司機</a>
    </li>
    <li class="nav_item" data-content="GO有料" onclick="navigateTo('photowall.html')">
      <a href="./photowall.html">GO有料</a>
    </li>
    <li class="shoop">
      <a href="./shopping.html">
        <img src="./images/icon/header-icon/shoop.svg" alt="shopCar"
      /></a>
    </li>
    <li><!-- #ModalPage為Vue掛載的位置，不管用什麼裝置觸發，都必須要有這個ID -->
<!-- <div type="button" id="btn_log" class="btn_4">
  登入
</div> -->

<div id="ModalPage" class="login123">
  <!-- 此處為用@click綁定事件，用data中的"ispop"資料，來控制燈箱跳出
        如果要綁定在其它物件上，只要打上@click這條即可觸發。 -->
  <div type="button" @click="ispop = true; changePage(0)" class="btn_4" v-show="success === false">
    登入
  </div>
  <transition name="slide-fade">
    <div v-show="success === true">
      <a href="./member.html">
        <svg width="25" height="25" viewBox="0 0 67 68" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M33.5003 0.666748C15.1003 0.666748 0.166992 15.6001 0.166992 34.0001C0.166992 52.4001 15.1003 67.3334 33.5003 67.3334C51.9003 67.3334 66.8337 52.4001 66.8337 34.0001C66.8337 15.6001 51.9003 0.666748 33.5003 0.666748ZM33.5003 14.0001C39.9337 14.0001 45.167 19.2334 45.167 25.6667C45.167 32.1001 39.9337 37.3334 33.5003 37.3334C27.067 37.3334 21.8337 32.1001 21.8337 25.6667C21.8337 19.2334 27.067 14.0001 33.5003 14.0001ZM33.5003 60.6668C26.7337 60.6668 18.7337 57.9334 13.0337 51.0668C18.8723 46.4858 26.0791 43.9961 33.5003 43.9961C40.9216 43.9961 48.1283 46.4858 53.967 51.0668C48.267 57.9334 40.267 60.6668 33.5003 60.6668Z"
            fill="#09003E" />
        </svg>
      </a>
    </div>
  </transition>

  <!-- 用v-if來渲染出燈箱畫面，此處的v-if渲染內容為燈箱主體，不可更動。 -->
  <template v-if="ispop === true">
    <div class="lightbox" @click="ispop = false">
      <!-- loginpage_base為燈箱主版面，未RWD前寬度已經寫死為500px。 -->
      <div class="loginpage_base" @click.stop>
        <!-- close中存在關閉燈箱渲染的控件，為燈箱主體，不可更改 -->
        <div class="close">
          <div class="icon" @click="ispop = false">
            <img src="./images/icon/components-icon/close-line.svg" alt="close" />
          </div>
        </div>
        <!-- 此處為燈箱切換頁面的主體，用v-if渲染出不同的內文，用data:index來控制要渲染的頁面。
                    同一class但不同 index的div 即為不同的頁面，所有要開發的頁面，都要放在同一層級。 -->

        <!-- index 0 登入頁面 -->
        <transition name="slide-fade">
          <template v-if="index === 0">
            <div class="loginPage">
              <div class="pageIsideContainer">
                <h5>登入/註冊</h5>
                <!-- 此處綁定了自行寫入的post事件 -->
                <form @submit.prevent="handleSubmit">
                  <!-- sectionHead本身不包含任何屬性，為了要完全貼齊form的上轅。 -->
                  <div class="sectionHead">
                    <label for="account">帳號</label>
                    <input type="email" id="account" name="account" placeholder="請輸入E-MAIL" class="loginType"
                      v-model="account" />
                  </div>
                  <!-- sectionBody包含了向上與向下的間距，要調整的方向在這裡。 -->
                  <!-- <div class="sectionBody"> -->
                  <label for="password">密碼</label>
                  <input type="password" id="password" name="password" placeholder="請輸入密碼" class="loginType noMb24"
                    v-model="password" />
                  <a class="mb_24" @click="changePage(1)">忘記密碼?</a>
                  <!-- </div> -->
                  <div class="submit">
                    <input type="button" class="btn_5" value="登入" @click="ispop = false, success = true" />
                  </div>
                </form>
                <div class="register">
                  <p>還沒成為PetpaGo會員?</p>
                  <span @click="changePage(4)">立即註冊</span>
                </div>
                <div class="otherTypeToLogin">
                  <p>或其它登入方式</p>
                </div>
                <div class="otherIcon">
                  <a href="#">
                    <img src="./images/icon/components-icon/fb-Logo.svg" alt="" />
                  </a>
                  <a href="#">
                    <img src="./images/icon/components-icon/google-Logo.svg" alt="" />
                  </a>
                </div>
              </div>
            </div>
          </template>

        </transition>


        <!-- index 1 忘記密碼接入頁面 -->
        <transition name="slide-fade">
          <div v-if="index === 1" class="loginPage">
            <div class="pageIsideContainer">
              <h5>重設密碼</h5>
              <p class="textColor_m-font">
                輸入你註冊PetpaGo帳號的電子信箱，我們會發送重設密碼的連結
              </p>
              <form action="#" method="post">
                <div class="sectionHead">
                  <label for="checkEmail">電子信箱</label>
                  <input type="email" placeholder="請輸入Email" id="checkEmail" class="loginType" />
                </div>
                <div class="submit">
                  <input type="button" class="btn_5" value="確認" @click="changePage(2)" />
                </div>
              </form>
            </div>
          </div>
        </transition>


        <!-- index 2 修改密碼頁面 -->
        <transition name="slide-fade">
          <template v-if="index === 2">
            <div class="loginPage">
              <div class="pageIsideContainer">
                <h5>重設密碼</h5>
                <form action="#" method="post">
                  <div class="sectionHead">
                    <label for="passwordCheck">新密碼</label>
                    <input type="password" id="passwordCheck" name="password" placeholder="請輸入" class="loginType" />
                  </div>
                  <!-- <div class="sectionBody"> -->
                  <label for="passwordCheck1">請再次輸入新密碼</label>
                  <input type="password" id="passwordCheck1" name="password" placeholder="請輸入" class="loginType" />
                  <!-- </div> -->
                  <div class="submit">
                    <input type="button" class="btn_5" value="確認重設" @click="changePage(3)" />
                  </div>
                </form>
              </div>
            </div>
          </template>

        </transition>


        <!-- index 3 忘記密碼/設定成功 -->
        <transition name="slide-fade">
          <template v-if="index === 3">
            <div class="loginPage succPag">
              <div class="pageIsideContainer">
                <img src="./images/icon/components-icon/success.svg" alt="" />
                <h5 class="mb_24">密碼重設成功</h5>
                <button type="button" class="btn_5" @click="changePage(0)">
                  確認
                </button>
              </div>
            </div>
          </template>

        </transition>


        <!-- index 4 註冊會員 -->
        <transition name="slide-fade">
          <template v-if="index === 4">
            <div class="loginPage">
              <div class="pageIsideContainer">
                <h5>註冊會員</h5>

                <form action="#" method="post">
                  <div class="sectionHead">
                    <label for="member_name">姓名</label>
                    <input type="text" id="member_name" name="member_name" placeholder="請輸入" class="loginType" />
                  </div>
                  <!-- <div class="sectionBody"> -->
                  <label for="user_mail">電子信箱</label>
                  <input type="email" id="user_mail" name="user_mail" placeholder="請輸入" class="loginType" />
                  <!-- </div> -->
                  <!-- <div class="sectionBody"> -->
                  <label for="new_password">使用者密碼</label>
                  <input type="password" id="new_password" name="new_password" placeholder="請輸入" class="loginType" />
                  <!-- </div> -->
                  <!-- <div class="sectionBody"> -->
                  <label for="new_passwordCheck">請再次輸入使用者密碼</label>
                  <input type="password" id="new_passwordCheck" name="new_passwordCheck" placeholder="請輸入"
                    class="loginType" />
                  <!-- </div> -->
                  <div class="submit">
                    <input type="button" class="btn_5" value="立即加入" @click="changePage(0)" />
                  </div>
                </form>
              </div>
            </div>
          </template>

        </transition>

      </div>
    </div>
  </template>

</div>
<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
<script>
  // const click_el = document.getElementById("btn_log");
  // click_el.addEventListener('click', function () {
  //   const ModalPage_el = document.getElementById("ModalPage");
  //   ModalPage_el.classList.remove("login123");
  //   vm.ispop = true;
  //   vm.changePage(0);
  // })

  function removeLogin123Class() {
    setTimeout(() => {
      const modalPage = document.getElementById("ModalPage");
      if (modalPage) {
        modalPage.classList.remove("login123");
      }
    }, 10); // 10 毫秒后执行
  }

  // 调用函数
  removeLogin123Class();



  const ModalPage = Vue.createApp({
    data() {
      return {
        text: "Hello World!",
        returnStatus: "",
        index: 0,
        ispop: false,
        account: "",
        password: "",
        success: false
      };
    },
    methods: {
      changePage(newIndex) {
        this.index = newIndex;
      },
      handleSubmit() {
        // 執行表單提交的處理
        fetch("/php/login.php", {
          method: "POST",
          mode: "cors",
          body: new URLSearchParams({
            account: this.account,
            password: this.password,
          }),
        })
          .then((response) => response.json()) // 解析 JSON 回應
          .then((data) => {
            if (data.status === "success") {
              // 如果回應為成功，執行頁面跳轉
              window.open("member.html", "_self");
            } else if (data.status === "error") {
              // 如果回應為錯誤，處理無效認證的情況
              console.log(data.message);
            }
          })
          .catch((error) => {
            console.error("Error:", error);
          });
      },
    },
  });

  const vm = ModalPage.mount("#ModalPage");

</script></li>
    <li class="userIcon">
      <svg
        width="25"
        height="25"
        viewBox="0 0 67 68"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M33.5003 0.666748C15.1003 0.666748 0.166992 15.6001 0.166992 34.0001C0.166992 52.4001 15.1003 67.3334 33.5003 67.3334C51.9003 67.3334 66.8337 52.4001 66.8337 34.0001C66.8337 15.6001 51.9003 0.666748 33.5003 0.666748ZM33.5003 14.0001C39.9337 14.0001 45.167 19.2334 45.167 25.6667C45.167 32.1001 39.9337 37.3334 33.5003 37.3334C27.067 37.3334 21.8337 32.1001 21.8337 25.6667C21.8337 19.2334 27.067 14.0001 33.5003 14.0001ZM33.5003 60.6668C26.7337 60.6668 18.7337 57.9334 13.0337 51.0668C18.8723 46.4858 26.0791 43.9961 33.5003 43.9961C40.9216 43.9961 48.1283 46.4858 53.967 51.0668C48.267 57.9334 40.267 60.6668 33.5003 60.6668Z"
          fill="#09003E"
        />
      </svg>
    </li>
    <li>
      <div class="shopping-cart"><!-- 購物車彈跳窗 -->

<!-- first list box2 -->
<div class="ol-content">
    <!-- box2-1 -->
    <div class="ol-contentBox mb_24">
      <div class="ol-ContText">
        <div class="ol-title">
            <h6>寵物接送</h6>
            <img src="./images/icon/shop-icon/delete.svg" alt="">
        </div>
        <p style="color: #555;font-weight: normal; font-size: 14px;">8月17日 ｜ 16:00</p>
        <div class="ol-info jcSb mb_16">
          <p style="color: #555;font-weight: normal; font-size: 14px;">轎車</p>
          <span style="font-size: normal; font-size: 14px;">NT$ 300</span>
        </div>
      </div>
    </div>
    <!-- box2-2 -->
    <div class="ol-contentBox mb_24">
      <div class="ol-ContText">
        <div class="ol-title">
            <h6>寵物接送</h6>
            <img src="./images/icon/shop-icon/delete.svg" alt="">
        </div>
        <p style="color: #555;font-weight: normal; font-size: 14px;">8月17日-8月19日 (3晚)</p>
        <div class="ol-info jcSb mb_16">
          <p style="color: #555;font-weight: normal; font-size: 14px;">狗套房X1 ｜ 小型犬</p>
          <span style="font-size: normal; font-size: 14px;">NT$ 2,400</span>
        </div>
      </div>
    </div>
    <!-- box2-3 -->
    <div class="ol-contentBox mb_24">
      <div class="ol-ContText">
        <div class="ol-title">
            <h6>快樂寵物旅館</h6>
            <img src="./images/icon/shop-icon/delete.svg" alt="">
        </div>
        <p style="color: #555;font-weight: normal; font-size: 14px;">8月17日-8月19日 (3晚)</p>
        <div class="ol-info jcSb mb_16">
          <p style="color: #555;font-weight: normal; font-size: 14px;">貓套房X1 ｜ 貓咪</p>
          <span style="font-size: normal; font-size: 14px;">NT$ 2,400</span>
        </div>
      </div>
    </div>
    <!-- checkout-note -->
    <div class="checkout">
        <div class="product-count">
            <p style="color: #555; font-size: normal; font-size: 14px;">共3件商品</p>
            <span style="font-size: 18px;">NT$ 5,100</span>
        </div>
        <button class="btn_4">查看購物車</button>
    </div>
  </div>

</div>
    </li>
  </ul>

  <!-- hamburger -->
  <div class="hamburgerList col-10">
    <a href="./shopping.html">
      <img src="./images/icon/header-icon/shoop.svg" alt="shopCar"
    /></a>

    <div class="l-header">
      <div class="l-header__hambuger">
        <div class="hambuger js-click">
          <div class="hambuger__icon">
            <div class="lines">
              <div class="line line--top"></div>
              <div class="line line--bottom"></div>
            </div>
          </div>

          <div class="hambuger__body">
            <div class="bg" id="hambugerBg"></div>
            <div class="body" id="hambugerBody">
              <ul class="menu-list">
                <li class="item">
                  <p class="title">
                    <img
                      src="./images/logo/PetpaGo-whiteLogo.svg"
                      alt="logo"
                      width="150px"
                    />
                    <!-- <span class="en">Top</span>
                    <span class="ja">回首頁</span> -->
                  </p>
                  <a class="link" href="/"></a>
                </li>

                <li class="item">
                  <p class="title">
                    <span class="en">Go旅宿</span>
                    <span class="ja">你出國 毛小孩也度假去</span>
                  </p>
                  <a class="link" href="./hostel.html"></a>
                </li>

                <li class="item">
                  <p class="title">
                    <span class="en">Go司機</span>
                    <span class="ja">無縫接送毛小孩</span>
                  </p>
                  <a class="link" href="./driver.html"></a>
                </li>

                <li class="item">
                  <p class="title">
                    <span class="en">Go有料</span>
                    <span class="ja">hiHi 我們一家毛</span>
                  </p>
                  <a class="link" href="./photowall.html"></a>
                </li>

                <li class="item">
                  <p class="title">
                    <span class="en">會員中心</span>
                    <span class="ja">累計點數 賺回饋goGo</span>
                  </p>
                  <a class="link" href="./member.html"></a>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>

<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.20.3/TweenMax.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mo-js/0.288.2/mo.min.js"></script>
<script>
  // rwd nav button
  function navigateTo(url) {
            window.location.href = url;
        };
  
  class Hambuger {
    constructor() {
      window.pc = true;

      let shapePhilosophy = new mojs.Shape({
        parent: document.getElementById("hambugerBg"),
        shape: "circle",
        radius: window.pc ? 20 : 20,
        // angle: 30,
        fill: "#6e60f6",
        opacity: 1,
        isShowStart: true,
      });

      let hambugerIcon = document.getElementsByClassName("hambuger__icon")[0];
      let lineTop = document.getElementsByClassName("line--top")[0];
      let lineBottom = document.getElementsByClassName("line--bottom")[0];
      let menuBody = document.getElementById("hambugerBody");
      let items = menuBody.querySelectorAll(".item");

      hambugerIcon.addEventListener("click", () => {
        hambugerIcon.classList.toggle("is-open");
        if (hambugerIcon.classList.contains("is-open")) {
          shapePhilosophy.then({
            scale: window.pc ? 80 : 40,
            duration: 600,
            // opacity: 1,
            easing: "expo.out",
          });
          menuBody.style.display = "block";
          TweenMax.staggerTo(
            items,
            0.3,
            {
              opacity: 1,
              y: 0,
              delay: 0.2,
              ease: Power2.easeOut,
            },
            0.075
          );
          TweenMax.to(lineTop, 0.4, {
            y: 2,
            ease: Power4.easeOut,
            onComplete: () => {
              TweenMax.to(lineTop, 0.4, {
                rotation: 45,
                transformOrigin: "center center",
                ease: Power4.easeOut,
              });
            },
          });
          TweenMax.to(lineBottom, 0.4, {
            y: -2,
            transformOrigin: "left top",
            ease: Power4.easeOut,
            onComplete: () => {
              TweenMax.to(lineBottom, 0.4, {
                rotation: -45,
                transformOrigin: "center center",
                ease: Power4.easeOut,
              });
            },
          });
          // 禁用捲軸
          document.body.style.overflow = "hidden";
        } else {
          shapePhilosophy.then({
            scale: 1,
            duration: 400,
            delay: 300,
            easing: "expo.out",
          });
          TweenMax.staggerTo(
            items,
            0.2,
            {
              opacity: 0,
              y: "20px",
              onComplete: () => {
                menuBody.style.display = "none";
              },
            },
            0.01
          );
          TweenMax.to(lineTop, 0.4, {
            rotation: 0,
            transformOrigin: "center center",
            ease: Power4.easeOut,
            onComplete: () => {
              TweenMax.to(lineTop, 0.4, {
                y: 0,
                ease: Power4.easeOut,
              });
            },
          });
          TweenMax.to(lineBottom, 0.4, {
            rotation: 0,
            transformOrigin: "center center",
            ease: Power4.easeOut,
            onComplete: () => {
              TweenMax.to(lineBottom, 0.4, {
                y: 0,
                transformOrigin: "left top",
                ease: Power4.easeOut,
              });
            },
          });
          // 啟用捲軸
          document.body.style.overflow = "auto";
        }
        shapePhilosophy.play();
      });
    }
  }

  new Hambuger();
</script>

<script>
  //滑鼠移到購物車上面的展示效果
  document.addEventListener("DOMContentLoaded", () => {
    const shoopElement = document.querySelector(".shoop");
    const shoppingCartElement = document.querySelector(".shopping-cart");

    shoopElement.addEventListener("mouseenter", () => {
      shoppingCartElement.style.display = "block";
    });

    shoopElement.addEventListener("mouseleave", () => {
      shoppingCartElement.style.display = "none";
    });
  });
</script>

      <div class="sp_container" id="spApp">
        <!--進度條-->
        <div class="spStep_bg">
          <div class="spStep_box col-10 col-sm-12">
            <button
              v-for="(step, index) in steps"
              :key="index"
              class="spStep"
              :class="{ 'jsNow': index <= currentStep }"
              @click="setCurrentStep(index)"
              type="button"
              :disabled="index > currentStep"
            >
              {{ step }}
            </button>
          </div>
        </div>
        <div class="spMain_bg">
          <form class="sp_form">
            <!--步驟一內容-->
            <div class="spPage" :class="{'jsNow':currentStep === 0}">
              <div class="spMain_wrapper">
                <h5 class="spMian_title">您的購物車</h5>
                <div class="spMain">
                  <div class="spMain_left col-7 col-lg-12">
                    <div class="spCard">
                      <!-- 用 v-model 與 checked 綁定，控制全選的狀態。@change監聽變化並呼叫 allChecked 函數。 -->
                      <input
                        type="checkbox"
                        v-model="checked"
                        @change="allChecked"
                      />
                      <label>
                        <div>全選</div>
                      </label>
                    </div>
                    <!-- 使用 v-for 為每個項目應用CSS類別。 -->
                    <div
                      v-for="(item, index) in shoppingItems"
                      :key="index"
                      :class="['spCard', item.type]"
                    >
                      <div class="spCard_up">
                        <!-- checkbox與 checkedNames 綁定，記錄選中的商品。 -->
                        <input
                          type="checkbox"
                          :value="item.id"
                          v-model="checkedNames"
                        />
                        <label>
                          <picture>
                            <source
                              :srcset="item.pictureSrc_m"
                              media="(max-width: 414px)"
                            />
                            <img :src="item.pictureSrc" />
                          </picture>
                        </label>
                        <div class="spBuy_text">
                          <div class="spList_up">
                            <h6>{{ item.product }}</h6>
                            <!-- 綁定確認刪除事件 -->
                            <img
                              src="./images/icon/shop-icon/delete.svg"
                              @click="confirmDelete(index)"
                            />
                          </div>
                          <div class="spList_down">
                            <p>{{ useDate(item) }}</p>
                            <p v-if="item.listType === '狗套房'">
                              {{ item.listType }} ｜ {{ item.dogSize}}
                            </p>
                            <p v-else>{{ item.listType }}</p>
                          </div>
                        </div>
                      </div>
                      <div class="spSubtotal">
                        <!-- 是否有 spStepper 屬性，顯示加減按鈕 -->
                        <div v-if="item.spStepper">
                          <div class="spStepper">
                            <!-- updateAmount、updateSubtotal:增減數量並更新小計 -->
                            <div
                              class="spSubtotal_icon"
                              @click="updateAmount(item, -1)"
                              :class="{ 'limit': item.BuyNum === 1 }"
                            >
                              <svg
                                width="11"
                                height="3"
                                viewBox="0 0 11 3"
                                fill="none"
                                xmlns="http://www.w3.org/2000/svg"
                              >
                                <path
                                  d="M10.3125 0.875H0.6875C0.441406 0.875 0.25 1.09375 0.25 1.3125V2.1875C0.25 2.43359 0.441406 2.625 0.6875 2.625H10.3125C10.5312 2.625 10.75 2.43359 10.75 2.1875V1.3125C10.75 1.09375 10.5312 0.875 10.3125 0.875Z"
                                  fill="#E6E6E6"
                                />
                              </svg>
                            </div>
                            <input
                              type="number"
                              v-model="item.BuyNum"
                              @input="handleInput(item)"
                            />
                            <div
                              class="spSubtotal_icon"
                              @click="updateAmount(item, 1)"
                              :class="{ 'limit': item.BuyNum === 9 }"
                            >
                              <svg
                                width="11"
                                height="11"
                                viewBox="0 0 11 11"
                                fill="none"
                                xmlns="http://www.w3.org/2000/svg"
                              >
                                <path
                                  d="M10.3125 4.875H6.375V0.9375C6.375 0.71875 6.15625 0.5 5.9375 0.5H5.0625C4.81641 0.5 4.625 0.71875 4.625 0.9375V4.875H0.6875C0.441406 4.875 0.25 5.09375 0.25 5.3125V6.1875C0.25 6.43359 0.441406 6.625 0.6875 6.625H4.625V10.5625C4.625 10.8086 4.81641 11 5.0625 11H5.9375C6.15625 11 6.375 10.8086 6.375 10.5625V6.625H10.3125C10.5312 6.625 10.75 6.43359 10.75 6.1875V5.3125C10.75 5.09375 10.5312 4.875 10.3125 4.875Z"
                                  fill="#5E5E5E"
                                />
                              </svg>
                            </div>
                          </div>
                        </div>
                        <!-- 小計的金額用函數 countSubtotal(item) 計算 -->
                        <p>
                          NT${{ countSubtotal(item) }}
                        </p>
                      </div>
                    </div>
                  </div>
                  <div class="spMain_right col-5 col-lg-12">
                    <div class="spCard">
                      <div class="spTotal mb_32">
                        <!-- totalItems 和 totalPrice 分別計算總件數和總＄。 -->
                        <p>{{ this.checkedNames.length }}件總計</p>
                        <h5>NT${{ totalPrice.toLocaleString('en-US') }}</h5>
                      </div>
                      <button
                        class="spNext btn_5 jsNext"
                        type="button"
                        @click="caculate_point();currentStep ++"
                      >
                        下一步
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              <section class="ad_section mb_100">
  <div class="ad_box container">
    <div class="ad_box_icon col-12 ad_box_white">
      <img
        src="./images/icon/components-icon/ad-icon/ad-Icon01.svg"
        alt="add Member"
      />
      <div class="add_text">
        <h6 class="noneOn768">GO 旅宿</h6>
        <h6 class="blockOn768">
          立即加入會員，<br />
          省越多、賺越多！
        </h6>
        <p>首次下單，即贈30 PetPoint點！</p>
      </div>
    </div>
    <div class="ad_box_icon col-12 ad_box_white">
      <img
        src="./images/icon/components-icon/ad-icon/ad-Icon02.svg"
        alt="points"
      />
      <div class="add_text">
        <h6>GO司機</h6>
        <p class="noneOn414">輕鬆賺積分、享折扣，下次預訂更划算！</p>
        <p class="blockOn414">
          輕鬆賺積分、享折扣，<br />
          下次預訂更划算！
        </p>
      </div>
    </div>
  </div>
</section>

            </div>
            <!--步驟二內容-->
            <div class="spPage sp2" :class="{'jsNow':currentStep === 1}">
              <h5 class="spMian_title">聯絡資料</h5>
              <div class="spMain">
                <!-- 左內容 -->
                <div class="spMain_left col-7">
                  <div class="spCard spOrderMan">
                    <p>姓名：<span>*</span></p>
                    <input
                      type="text"
                      placeholder="請輸入姓名"
                      v-model="spOrderName"
                    />
                    <p>電子信箱：<span>*</span></p>
                    <input
                      type="email"
                      placeholder="請輸入Email"
                      v-model="spOrderEmail"
                    />
                    <p>行動電話：<span>*</span></p>
                    <input
                      type="tel"
                      placeholder="請輸入行動電話"
                      v-model="spOrderPhone"
                    />
                    <!-- 限制只可輸入數字 -->
                    <div class="spSame_member">
                      <input
                        type="checkbox"
                        v-model="sameMemberChecked"
                        @change="sameMember"
                      />
                      <label>同會員資料</label>
                    </div>
                    <p>備註：</p>
                    <textarea
                      rows="3"
                      placeholder="請輸入寵物品種/須注意事項/特殊需求"
                    ></textarea>
                  </div>
                  <h5 class="mb_32">優惠折扣</h5>
                  <div class="spCard">
                    <div class="spOrder_check">
                      <input type="checkbox" v-model="usePointsCheck" />
                      <label>我要使用 Pet Points</label>
                    </div>
                    <p>
                      可用 Pet Points
                      <span>{{ havePoints }}</span> 點，最多使用<input
                        type="number"
                        id="usePoint"
                        v-model="usePoints"
                        @input="handlePoints"
                      />點
                    </p>
                  </div>
                  <div class="spPay mb_32">
                    <h5>信用卡/簽帳金融卡付款</h5>
                    <span
                      ><img
                        src="./images/icon/shop-icon/mastercard.svg"
                        alt="" /><img
                        src="./images/icon/shop-icon/visa.svg"
                        alt="" /><img
                        src="./images/icon/shop-icon/ae.svg"
                        alt="" /><img
                        src="./images/icon/shop-icon/jcb.svg"
                        alt=""
                    /></span>
                  </div>
                  <div class="spCard">
                    <div class="creditCard">
                      <div class="col-4 col-lg-12">
                        <p>信用卡號碼<span>*</span></p>
                        <div>
                          <input
                            type="text"
                            ref="input1"
                            maxlength="4"
                            placeholder="0000"
                            @input="handleCC(1, 4)"
                            v-model="cardNumber[0]"
                          />
                          <input
                            type="text"
                            ref="input2"
                            maxlength="4"
                            placeholder="0000"
                            @input="handleCC(2, 4)"
                            v-model="cardNumber[1]"
                          />
                          <input
                            type="text"
                            ref="input3"
                            maxlength="4"
                            placeholder="0000"
                            @input="handleCC(3, 4)"
                            v-model="cardNumber[2]"
                          />
                          <input
                            type="text"
                            ref="input4"
                            maxlength="4"
                            placeholder="0000"
                            @input="handleCC(4, 4)"
                            v-model="cardNumber[3]"
                          />
                        </div>
                      </div>
                      <div class="col-4 col-lg-12">
                        <p>有效期限<span>*</span></p>
                        <div>
                          <input
                            type="text"
                            ref="input5"
                            maxlength="2"
                            placeholder="MM"
                            @input="handleCC(5, 2)"
                            v-model="cardDate[0]"
                            requiredd="required"
                          />
                          /<input
                            type="text"
                            ref="input6"
                            maxlength="2"
                            placeholder="YY"
                            @input="handleCC(6, 2)"
                            v-model="cardDate[1]"
                            requiredd="required"
                          />
                        </div>
                      </div>
                      <div class="col-4 col-lg-12">
                        <p>背面後3碼<span>*</span></p>
                        <input
                          type="text"
                          placeholder="CVC/CVV"
                          maxlength="3"
                          minlength="3"
                          ref="input7"
                          @input="handleCC(7, 3)"
                          v-model="cardCVC"
                          required="required"
                        />
                      </div>
                    </div>
                    <p>
                      請注意本平台不會向您收取任何平台交易手續費，但你下單時使用的信用卡可能會向您收取相關手續費，
                      請參考其相關服務政策和規定，並向你所選的交易服務商取得更多資訊。
                    </p>
                  </div>
                </div>
                <!-- 總計 -->
                <div class="spMain_right col-5">
                  <div class="spCard">
                    <div
                      class="spBuy_text"
                      v-for="(item, index) in selectedItems"
                      :key="index"
                    >
                      <div class="spList_up">
                        <h6>{{ item.product }}</h6>
                      </div>
                      <div class="spList_down">
                        <p>{{ useDate(item) }}</p>
                        <div>
                          <p v-if="item.listType === '狗套房'">
                            {{ item.listType }} ｜ {{ item.dogSize }}
                          </p>
                          <p v-else>{{ item.listType }}</p>
                          <p>
                            NT${{ countSubtotal(item).toLocaleString('en-US') }}
                          </p>
                        </div>
                      </div>
                    </div>
                    <div class="spBuy_text spCount">
                      <div>
                        <p>{{ this.checkedNames.length }}件合計</p>
                        <p>NT${{ totalPrice.toLocaleString('en-US') }}</p>
                      </div>
                      <div>
                        <p>Pet Points 折抵</p>
                        <p>
                          -NT$ {{ (usePointsCheck ? usePoints :
                          0).toLocaleString('en-US') }}
                        </p>
                      </div>
                    </div>
                    <div class="spTotal">
                      <p>{{ this.checkedNames.length }}件總計</p>
                      <h5>
                        NT${{(usePointsCheck ? payPrice :
                        totalPrice).toLocaleString('en-US')}}
                      </h5>
                    </div>
                    <!-- <button class="spNext btn_5 jsNext" type="button"
                                        @click="currentStep ++ ">下一步</button> -->
                    <button
                      class="spNext btn_5 jsNext"
                      type="button"
                      @click="checkform"
                    >
                      下一步
                    </button>
                    <div>
                      <img
                        src="./images/icon/member-icon/black-points.svg"
                        alt=""
                      />
                      <p>
                        可獲得 Pet Points
                        <span>{{Math.floor((payPrice)/100)}}</span> 點
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!--步驟三內容-->
            <div class="spPage" :class="{'jsNow':currentStep === 2}">
              <div class="spMain sp3">
                <div class="mb_32">
                  <img src="./images/icon/components-icon/success.svg" alt="" />
                  <h5>訂單完成</h5>
                  <p>訂單資料將寄送至：service@tibame.com</p>
                </div>
                <div class="spCard">
                  <ul>
                    <li class="accordion">
                      <!-- first list box1 -->
                      <div class="ol-header mb_24">
                        <div class="ol-headText">
                          <p>訂單日期：{{ nowDate }}</p>
                          <p>訂單編號：{{ orderID }}</p>
                        </div>
                      </div>
                      <!-- first list box2 -->
                      <div class="ol-content mb_24">
                        <!-- box2-1 -->
                        <div
                          class="ol-contentBox mb_24"
                          v-for="(item, index) in selectedItems"
                          :key="index"
                        >
                          <img :src="item.pictureSrc" />
                          <div class="ol-ContText">
                            <h6 class="mb_16">{{ item.product }}</h6>
                            <p>{{ useDate(item) }}</p>
                            <div class="ol-info">
                              <p v-if="item.listType === '狗套房'">
                                {{ item.listType }} ｜ {{ item.dogSize }}
                              </p>
                              <p v-else>{{ item.listType }}</p>
                              <p>
                                NT${{
                                countSubtotal(item).toLocaleString('en-US') }}
                              </p>
                            </div>
                          </div>
                        </div>
                      </div>
                      <!-- first list box3 -->
                      <div class="ol-money mb_24">
                        <div class="ol-count mb_16">
                          <p>{{ this.checkedNames.length }}件合計</p>
                          <span
                            >NT$ {{ totalPrice.toLocaleString('en-US') }}</span
                          >
                        </div>
                        <div class="ol-count">
                          <p>Pet Points 折抵</p>
                          <span
                            >-NT$ {{ (usePointsCheck ? usePoints :
                            0).toLocaleString('en-US') }}</span
                          >
                        </div>
                      </div>
                      <!-- first list box4 -->
                      <div class="ol-total">
                        <div class="ol-count mb_24">
                          <p>總計</p>
                          <span
                            >NT$ {{(usePointsCheck ? payPrice :
                            totalPrice).toLocaleString('en-US')}}</span
                          >
                        </div>
                        <p>
                          <img
                            src="./images/icon/member-icon/black-points.svg"
                            alt="points-icon"
                          />已獲得 Pet Points
                          <span>{{Math.floor((payPrice)/100)}}</span> 點
                        </p>
                      </div>
                    </li>
                  </ul>
                </div>
                <div class="spCard OrderMan">
                  <div>
                    <p>姓名</p>
                    <p>{{ spOrderName }}</p>
                  </div>
                  <div>
                    <p>電子信箱</p>
                    <p>{{ spOrderEmail }}</p>
                  </div>
                  <div>
                    <p>行動電話</p>
                    <p>{{ spOrderPhone }}</p>
                  </div>
                </div>
                <button
                  class="btn_5 btn-success"
                  type="button"
                  id="Go_index"
                  @click="goToIndex"
                >
                  回首頁
                </button>
              </div>
            </div>
          </form>
        </div>
      </div>
      <footer>
  <div class="footer_container">
    <div class="f_box">
      <img src="./images/logo/PetpaGo-whiteLogo.svg" alt="PetpaGo" />
      <ul>
        <li><a href="about.html">關於我們</a></li>
        <li><a href="faq.html">常見問題</a></li>
        <li><a href="#">廣告服務</a></li>
        <li><a href="#">與我們聯絡</a></li>
      </ul>
    </div>
    <div class="f_box">
      <p>
        本網站為緯育TibaMe【第85期】前端工程師專業技術養成班學員作品，僅供學習、展示之用途。
      </p>
      <ul>
        <li>
          <img src="./images/icon/footer-icon/Facebook.svg" alt="Facebook" />
        </li>
        <li>
          <img src="./images/icon/footer-icon/Twitter.svg" alt="Twitter" />
        </li>
        <li>
          <img src="./images/icon/footer-icon/Instagram.svg" alt="Instagram" />
        </li>
      </ul>
    </div>
    <div class="f_box boxLine">
      <p>©2023 PetpaGO Inc. All rights reserved.</p>
      <ul>
        <li><a href="#">服務聲明</a></li>
        <li><a href="#">隱私權聲明</a></li>
      </ul>
    </div>
  </div>
</footer>

    </div>

    <script>
      const app = Vue.createApp({
        data() {
          return {
            currentStep: 0,
            steps: ["查看購物車", "填寫資料", "完成付款"],
            checked: false,
            checkedNames: [],

            member_data: {
              name: "王緯育",
              email: "service@tibame.com",
              phone: "0912345678",
            },

            spOrderName: "",
            spOrderEmail: "",
            spOrderPhone: "",
            sameMemberChecked: false,
            havePoints: 100,
            usePoints: 0,
            usePointsCheck: true,

            nowDate: null,
            orderID: "PT0004",

            spReadyName: "",
            spReadyEmail: "",
            spReadyPhone: "",

            cardNumber: ["", "", "", ""],
            cardDate: ["", ""],
            cardCVC: "",
            isStepTwoValid: false,
            validationErrors: [],
            shoppingItems: [
              {
                id: "Car",
                type: "spDriver",
                pictureSrc_m: "./images/pic/shop/goShop01_m.png",
                pictureSrc: "./images/pic/shop/goShop01.png",
                product: "寵物接送",
                listType: "轎車",
                spStepper: false,
                spPrice: 300,
                BuyNum: 1,
                listDate_S: "8/17",
                listDate_E: "8/17",
                listDate_T: "16:00",
              },
              {
                id: "Hostel1",
                type: "spHostel",
                pictureSrc_m: "./images/pic/shop/goShop02_m.png",
                pictureSrc: "./images/pic/shop/goShop02.png",
                product: "快樂寵物旅館",
                listType: "狗套房",
                dogSize: "小型犬",
                spStepper: true,
                spPrice: 800,
                BuyNum: 1,
                listDate_S: "8/17",
                listDate_E: "8/20",
                listDate_T: "16:00",
              },
              {
                id: "Hostel2",
                type: "spHostel",
                pictureSrc_m: "./images/pic/shop/goShop03_m.png",
                pictureSrc: "./images/pic/shop/goShop03.png",
                product: "快樂寵物旅館",
                listType: "貓套房",
                spStepper: true,
                spPrice: 800,
                BuyNum: 1,
                listDate_S: "8/17",
                listDate_E: "8/20",
                listDate_T: "16:00",
              },
            ],
          };
        },
        // 預設全選。
        mounted() {
          this.checked = true;
          this.checkedNames = this.shoppingItems.map((item) => item.id);

          let nextButton = document.getElementById("Go_index");
          nextButton.addEventListener("click", () => {
            window.location.href = "index.html";
          });

          const options = { year: "numeric", month: "long", day: "numeric" };
          this.nowDate = new Date().toLocaleDateString("zh-TW", options);
        },
        methods: {
          sameMember() {
            if (this.sameMemberChecked === true) {
              this.spOrderName = this.member_data.name;
              this.spOrderEmail = this.member_data.email;
              this.spOrderPhone = this.member_data.phone;
            }
          },
          caculate_point() {
            if (this.havePoints < this.totalPrice * 0.2) {
              this.usePoints = this.havePoints;
            } else {
              this.usePoints = this.totalPrice * 0.2;
            }
          },
          setCurrentStep(index) {
            this.currentStep = index;
          },
          // 切換全選狀態。如果checked為true，則將checkedNames設置為所有購物項目的ID，否則將其清空。
          allChecked() {
            if (this.checked) {
              this.checkedNames = this.shoppingItems.map((item) => item.id);
            } else {
              this.checkedNames = [];
            }
          },
          // 格式化日期資訊，顯示成特定的格式
          useDate(item) {
            if (item.spStepper) {
              item.listDate_D = Math.round(
                (new Date(item.listDate_E) - new Date(item.listDate_S)) /
                  (1000 * 60 * 60 * 24)
              );
              const formattedStartDate = this.formatDate(item.listDate_S);
              const formattedEndDate = this.formatDate(item.listDate_E);
              return `${formattedStartDate} - ${formattedEndDate} (${item.listDate_D}晚)`;
            } else {
              const formattedDate = this.formatDate(item.listDate_S);
              return `${formattedDate} ｜ ${item.listDate_T}`;
            }
          },
          updateSubtotal(item) {
            if (item.spStepper) {
              item.listDate_D = Math.round(
                (new Date(item.listDate_E) - new Date(item.listDate_S)) /
                  (1000 * 60 * 60 * 24)
              );
              item.spSubtotal = item.spPrice * item.BuyNum * item.listDate_D;
            } else {
              item.listDate_D = 1;
              item.spSubtotal = item.spPrice * item.BuyNum * item.listDate_D;
            }
          },
          // 計算小計(單價、數量和天數)
          countSubtotal(item) {
            console.log(item);
            if (item.spStepper) {
              item.listDate_D = Math.round(
                (new Date(item.listDate_E) - new Date(item.listDate_S)) /
                  (1000 * 60 * 60 * 24)
              );
              return item.spPrice * item.BuyNum * item.listDate_D;
            } else {
              item.listDate_D = 1;
              return item.spPrice * item.BuyNum * item.listDate_D;
            }
          },
          // 更新數量，更新小計。
          updateAmount(item, change) {
            if (item.BuyNum < 9) {
              item.BuyNum = Math.max(1, item.BuyNum + change);
            } else if (item.BuyNum >= 9) {
              item.BuyNum = 8;
              item.BuyNum = Math.max(1, item.BuyNum + change);
            }
            this.updateSubtotal(item);
          },
          // 限制輸入在1～9之間
          handleInput(item) {
            if (item.BuyNum < 1) {
              item.BuyNum = 1;
            } else if (item.BuyNum > 9) {
              item.BuyNum = 9;
            }
            this.updateSubtotal(item);
          },
          // 格式化日期
          formatDate(dateStr) {
            const [month, day] = dateStr.split("/");
            return `${Number(month)}月${Number(day)}日`;
          },
          // 確認是否移除
          confirmDelete(index) {
            const isConfirmed = confirm("確認移除嗎？");
            if (isConfirmed) {
              // 點擊後刪除當前.spCard
              this.shoppingItems.splice(index, 1);
              // 引用整理索引
              this.updateIndex();
            }
          },
          // 重新整理索引值
          updateIndex() {
            this.shoppingItems.forEach((item, index) => {
              item.index = index;
            });
          },
          goToIndex() {
            window.location.href = "index.html";
          },
          //信用卡焦點改變
          handleCC(index, lengthToCheck) {
            const inputElement = this.$refs[`input${index}`];
            const inputValue = inputElement.value;

            const pattern = /^[0-9]*$/;
            if (!pattern.test(inputValue)) {
              inputElement.value = "";
              return;
            }

            if (inputValue.length === lengthToCheck && index < 7) {
              this.$refs[`input${index + 1}`].focus();
            } else if (inputValue.length === 0 && index > 1) {
              this.$refs[`input${index - 1}`].focus();
            }
          },
          checkform() {
            this.validationErrors = [];
            if (this.spOrderName.trim() === "") {
              alert("姓名欄位不可為空值");
            } else if (!this.validateEmail(this.spOrderEmail)) {
              alert("請輸入正確的E-mail格式，例:XXX@XXX.XXX");
            } else if (!this.validatePhoneNumber(this.spOrderPhone)) {
              alert("請輸入正確的行動電話格式，例:09XXXXXXXX");
            } else if (this.cardNumber[0].trim() === "") {
              alert("信用卡欄位不可為空值");
            } else {
              this.currentStep++;
            }
          },
          validateEmail(email) {
            const emailRegex =
              /^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z]+$/;
            return emailRegex.test(email);
          },
          validatePhoneNumber(phone) {
            const phoneRegex = /^09\d{8}$/;
            return phoneRegex.test(phone);
          },
          resetSameMemberChecked() {
            this.sameMemberChecked = false;
          },
        },
        computed: {
          // 計算總價格。
          totalPrice() {
            return this.shoppingItems.reduce((total, item) => {
              if (this.checkedNames.includes(item.id)) {
                return total + this.countSubtotal(item);
              }
              return total;
            }, 0);
          },
          canUsePoints() {
            const max = this.countSubtotal(this.shoppingItems[0]) * 0.2;
            return this.havePoints <= max ? this.havePoints : max;
          },
          payPrice() {
            return this.totalPrice - this.usePoints;
          },
          // 過濾勾選商品
          selectedItems() {
            return this.shoppingItems.filter((item) =>
              this.checkedNames.includes(item.id)
            );
          },
        },
        watch: {
          // 監視checkedNames的變化。若所有都被選，checked為true，否為false。
          checkedNames(val) {
            this.checked = val.length === this.shoppingItems.length;
          },
        },
      });

      app.mount("#spApp");
    </script>
  </body>
</html>
